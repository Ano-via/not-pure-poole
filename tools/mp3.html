---
layout: post
title: "现代在线音乐播放器"
permalink: mp3.html
---


<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>现代在线音乐播放器</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* 保持 CSS 完全不变 */
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont;
      background: linear-gradient(135deg, #f8fafc, #e2e8f0);
      color: #0f172a;
      display: flex;
      justify-content: center;
      padding: 30px;
    }
    .player {
      width: 360px;
      background: #ffffff;
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(15,23,42,.15);
    }
    .cover {
      width: 180px;
      height: 180px;
      border-radius: 50%;
      overflow: hidden;
      margin: 0 auto 16px;
      background-size: cover;
      background-position: center;
      animation: rotate 20s linear infinite;
      box-shadow: 0 10px 25px rgba(99,102,241,.35);
    }
    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .title {
      font-size: 18px;
      font-weight: 600;
      text-align: center;
      margin-bottom: 10px;
      color: #020617;
    }
    audio {
      width: 100%;
      margin-bottom: 12px;
    }
    .playlist {
      max-height: 160px;
      overflow-y: auto;
      margin-bottom: 12px;
    }
    .song {
      padding: 8px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
    }
    .song:hover { background: #e0e7ff; }
    .song.active { background: #6366f1; color: #fff; }
    .lyrics {
      background: #f8fafc;
      border: 1px solid #c7d2fe;
      border-radius: 14px;
      padding: 10px;
      height: 160px;
      overflow-y: auto;
      font-size: 13px;
      line-height: 1.6;
      color: #1e293b;
    }
    .line.active { color: #4f46e5; font-weight: bold; }
    .controls { display: flex; justify-content: space-around; margin-bottom: 12px; }
    .controls button {
      padding: 6px 14px;
      border: none;
      border-radius: 999px;
      background: #6366f1;
      color: #fff;
      cursor: pointer;
      font-size: 13px;
    }
    .controls button:hover { background: #4f46e5; }
  </style>
</head>
<body>
<div class="player">
  <div class="cover" id="cover"></div>
  <div class="title" id="songTitle">选择一首歌</div>

  <audio id="audio" controls></audio>

  <div class="controls">
    <button onclick="prevSong()">上一首</button>
    <button id="modeBtn" onclick="toggleMode()">列表循环</button>
    <button onclick="nextSong()">下一首</button>
  </div>

  <div class="playlist" id="playlist"></div>
  <div class="lyrics" id="lyrics"></div>
</div>

<script>
const songs = [
  { 
    title: "Blank Space", 
    artist: "Taylor Swift", 
    src: "music/Blank Space - Taylor Swift.mp3", 
    cover: "music/Blank Space - Taylor Swift.jpg",
    lrcFile: "music/Blank Space - Taylor Swift.src"
  },
{ 
    title: "Cruel Summer", 
    artist: "Taylor Swift", 
    src: "music/Cruel Summer - Taylor Swift.mp3", 
    cover: "music/Cruel Summer - Taylor Swift.jpg",
    lrcFile: "music/Cruel Summer - Taylor Swift.src"
  },
{ 
    title: "Ferrari", 
    artist: "Bebe Rexha", 
    src: "music/Ferrari - Bebe Rexha.mp3", 
    cover: "music/Ferrari - Bebe Rexha.jpg",
    lrcFile: "music/Ferrari - Bebe Rexha.src"
  },
{ 
    title: "Jar Of Love", 
    artist: "曲婉婷", 
    src: "music/Jar Of Love - 曲婉婷.mp3", 
    cover: "music/Jar Of Love - 曲婉婷.jpg",
    lrcFile: "music/Jar Of Love - 曲婉婷.src"
  },
{ 
    title: "K歌之王", 
    artist: "陈奕迅", 
    src: "music/K歌之王 - 陈奕迅.mp3", 
    cover: "music/K歌之王 - 陈奕迅.jpg",
    lrcFile: "music/K歌之王 - 陈奕迅.src"
  },
{ 
    title: "Style", 
    artist: "Taylor Swift", 
    src: "music/Style - Taylor Swift.mp3", 
    cover: "music/Style - Taylor Swift.jpg",
    lrcFile: "music/Style - Taylor Swift.src"
  },
{ 
    title: "Wonderful U (Demo Version)", 
    artist: "AGA", 
    src: "music/Wonderful U (Demo Version) - AGA.mp3", 
    cover: "music/Wonderful U (Demo Version) - AGA.jpg",
    lrcFile: "music/Wonderful U (Demo Version) - AGA.src"
  },
{ 
    title: "めざせポケモンマスター", 
    artist: "松本梨香", 
    src: "music/めざせポケモンマスター - 松本梨香.mp3", 
    cover: "music/めざせポケモンマスター - 松本梨香.jpg",
    lrcFile: "music/めざせポケモンマスター - 松本梨香.src"
  },
{ 
    title: "一丝不挂", 
    artist: "陈奕迅", 
    src: "music/一丝不挂 - 陈奕迅.mp3", 
    cover: "music/一丝不挂 - 陈奕迅.jpg",
    lrcFile: "music/一丝不挂 - 陈奕迅.src"
  },
{ 
    title: "一个人想着一个人", 
    artist: "曾沛慈", 
    src: "music/一个人想着一个人 - 曾沛慈.mp3", 
    cover: "music/一个人想着一个人 - 曾沛慈.jpg",
    lrcFile: "music/一个人想着一个人 - 曾沛慈.src"
  },
{ 
    title: "七友", 
    artist: "梁汉文", 
    src: "music/七友 - 梁汉文.mp3", 
    cover: "music/七友 - 梁汉文.jpg",
    lrcFile: "music/七友 - 梁汉文.src"
  },
{ 
    title: "下一站天后", 
    artist: "Twins", 
    src: "music/下一站天后 - Twins.mp3", 
    cover: "music/下一站天后 - Twins.jpg",
    lrcFile: "music/下一站天后 - Twins.src"
  },
{ 
    title: "下雨天", 
    artist: "南拳妈妈", 
    src: "music/下雨天 - 南拳妈妈.mp3", 
    cover: "music/下雨天 - 南拳妈妈.jpg",
    lrcFile: "music/下雨天 - 南拳妈妈.src"
  },
{ 
    title: "不浪漫罪名", 
    artist: "王杰", 
    src: "music/不浪漫罪名 - 王杰.mp3", 
    cover: "music/不浪漫罪名 - 王杰.jpg",
    lrcFile: "music/不浪漫罪名 - 王杰.src"
  },
{ 
    title: "你在，不在", 
    artist: "郭采洁", 
    src: "music/你在，不在 - 郭采洁.mp3", 
    cover: "music/你在，不在 - 郭采洁.jpg",
    lrcFile: "music/你在，不在 - 郭采洁.src"
  },
{ 
    title: "倒带", 
    artist: "蔡依林", 
    src: "music/倒带 - 蔡依林.mp3", 
    cover: "music/倒带 - 蔡依林.jpg",
    lrcFile: "music/倒带 - 蔡依林.src"
  },
{ 
    title: "偶尔还是会想起你", 
    artist: "牛奶咖啡", 
    src: "music/偶尔还是会想起你 - 牛奶咖啡.mp3", 
    cover: "music/偶尔还是会想起你 - 牛奶咖啡.jpg",
    lrcFile: "music/偶尔还是会想起你 - 牛奶咖啡.src"
  },
{ 
    title: "劲歌. 金曲2 (情歌王)", 
    artist: "古巨基", 
    src: "music/劲歌. 金曲2 (情歌王) - 古巨基.mp3", 
    cover: "music/劲歌. 金曲2 (情歌王) - 古巨基.jpg",
    lrcFile: "music/劲歌. 金曲2 (情歌王) - 古巨基.src"
  },
{ 
    title: "劲歌金曲", 
    artist: "古巨基", 
    src: "music/劲歌金曲 - 古巨基.mp3", 
    cover: "music/劲歌金曲 - 古巨基.jpg",
    lrcFile: "music/劲歌金曲 - 古巨基.src"
  },
{ 
    title: "十面埋伏", 
    artist: "陈奕迅", 
    src: "music/十面埋伏 - 陈奕迅.mp3", 
    cover: "music/十面埋伏 - 陈奕迅.jpg",
    lrcFile: "music/十面埋伏 - 陈奕迅.src"
  },
{ 
    title: "友情岁月", 
    artist: "郑伊健,陈小春,谢天华,钱嘉乐,林晓峰", 
    src: "music/友情岁月 - 郑伊健,陈小春,谢天华,钱嘉乐,林晓峰.mp3", 
    cover: "music/友情岁月 - 郑伊健,陈小春,谢天华,钱嘉乐,林晓峰.jpg",
    lrcFile: "music/友情岁月 - 郑伊健,陈小春,谢天华,钱嘉乐,林晓峰.src"
  },
{ 
    title: "喜帖街", 
    artist: "谢安琪", 
    src: "music/喜帖街 - 谢安琪.mp3", 
    cover: "music/喜帖街 - 谢安琪.jpg",
    lrcFile: "music/喜帖街 - 谢安琪.src"
  },
{ 
    title: "喜欢你", 
    artist: "G.E.M.邓紫棋", 
    src: "music/喜欢你 - G.E.M.邓紫棋.mp3", 
    cover: "music/喜欢你 - G.E.M.邓紫棋.jpg",
    lrcFile: "music/喜欢你 - G.E.M.邓紫棋.src"
  },
{ 
    title: "因为爱情(电影《将爱情进行到底》主题曲)", 
    artist: "陈奕迅,王菲", 
    src: "music/因为爱情(电影《将爱情进行到底》主题曲) - 陈奕迅,王菲.mp3", 
    cover: "music/因为爱情(电影《将爱情进行到底》主题曲) - 陈奕迅,王菲.jpg",
    lrcFile: "music/因为爱情(电影《将爱情进行到底》主题曲) - 陈奕迅,王菲.src"
  },
{ 
    title: "圆", 
    artist: "AGA", 
    src: "music/圆 - AGA.mp3", 
    cover: "music/圆 - AGA.jpg",
    lrcFile: "music/圆 - AGA.src"
  },
{ 
    title: "处处吻", 
    artist: "杨千嬅", 
    src: "music/处处吻 - 杨千嬅.mp3", 
    cover: "music/处处吻 - 杨千嬅.jpg",
    lrcFile: "music/处处吻 - 杨千嬅.src"
  },
{ 
    title: "多一点喜欢", 
    artist: "王舒", 
    src: "music/多一点喜欢 - 王舒.mp3", 
    cover: "music/多一点喜欢 - 王舒.jpg",
    lrcFile: "music/多一点喜欢 - 王舒.src"
  },
{ 
    title: "够钟", 
    artist: "周柏豪", 
    src: "music/够钟 - 周柏豪.mp3", 
    cover: "music/够钟 - 周柏豪.jpg",
    lrcFile: "music/够钟 - 周柏豪.src"
  },
{ 
    title: "大哥", 
    artist: "卫兰", 
    src: "music/大哥 - 卫兰.mp3", 
    cover: "music/大哥 - 卫兰.jpg",
    lrcFile: "music/大哥 - 卫兰.src"
  },
{ 
    title: "天梯", 
    artist: "C Allstar", 
    src: "music/天梯 - C Allstar.mp3", 
    cover: "music/天梯 - C Allstar.jpg",
    lrcFile: "music/天梯 - C Allstar.src"
  },
{ 
    title: "好きだから", 
    artist: "ユイカ", 
    src: "music/好きだから - ユイカ.mp3", 
    cover: "music/好きだから - ユイカ.jpg",
    lrcFile: "music/好きだから - ユイカ.src"
  },
{ 
    title: "好心分手", 
    artist: "卢巧音,王力宏", 
    src: "music/好心分手 - 卢巧音,王力宏.mp3", 
    cover: "music/好心分手 - 卢巧音,王力宏.jpg",
    lrcFile: "music/好心分手 - 卢巧音,王力宏.src"
  },
{ 
    title: "好心好报", 
    artist: "方力申,邓丽欣", 
    src: "music/好心好报 - 方力申,邓丽欣.mp3", 
    cover: "music/好心好报 - 方力申,邓丽欣.jpg",
    lrcFile: "music/好心好报 - 方力申,邓丽欣.src"
  },
{ 
    title: "如果的事", 
    artist: "张韶涵,范玮琪", 
    src: "music/如果的事 - 张韶涵,范玮琪.mp3", 
    cover: "music/如果的事 - 张韶涵,范玮琪.jpg",
    lrcFile: "music/如果的事 - 张韶涵,范玮琪.src"
  },
{ 
    title: "孤雏", 
    artist: "AGA", 
    src: "music/孤雏 - AGA.mp3", 
    cover: "music/孤雏 - AGA.jpg",
    lrcFile: "music/孤雏 - AGA.src"
  },
{ 
    title: "寂寞烟火", 
    artist: "朱婧汐", 
    src: "music/寂寞烟火 - 朱婧汐.mp3", 
    cover: "music/寂寞烟火 - 朱婧汐.jpg",
    lrcFile: "music/寂寞烟火 - 朱婧汐.src"
  },
{ 
    title: "富士山下", 
    artist: "陈奕迅", 
    src: "music/富士山下 - 陈奕迅.mp3", 
    cover: "music/富士山下 - 陈奕迅.jpg",
    lrcFile: "music/富士山下 - 陈奕迅.src"
  },
{ 
    title: "小幸运", 
    artist: "田馥甄", 
    src: "music/小幸运 - 田馥甄.mp3", 
    cover: "music/小幸运 - 田馥甄.jpg",
    lrcFile: "music/小幸运 - 田馥甄.src"
  },
{ 
    title: "少女的祈祷", 
    artist: "杨千嬅", 
    src: "music/少女的祈祷 - 杨千嬅.mp3", 
    cover: "music/少女的祈祷 - 杨千嬅.jpg",
    lrcFile: "music/少女的祈祷 - 杨千嬅.src"
  },
{ 
    title: "弥敦道", 
    artist: "洪卓立", 
    src: "music/弥敦道 - 洪卓立.mp3", 
    cover: "music/弥敦道 - 洪卓立.jpg",
    lrcFile: "music/弥敦道 - 洪卓立.src"
  },
{ 
    title: "当你", 
    artist: "王心凌", 
    src: "music/当你 - 王心凌.mp3", 
    cover: "music/当你 - 王心凌.jpg",
    lrcFile: "music/当你 - 王心凌.src"
  },
{ 
    title: "心墙", 
    artist: "郭静", 
    src: "music/心墙 - 郭静.mp3", 
    cover: "music/心墙 - 郭静.jpg",
    lrcFile: "music/心墙 - 郭静.src"
  },
{ 
    title: "必杀技", 
    artist: "古巨基", 
    src: "music/必杀技 - 古巨基.mp3", 
    cover: "music/必杀技 - 古巨基.jpg",
    lrcFile: "music/必杀技 - 古巨基.src"
  },
{ 
    title: "恋愛サーキュレーション", 
    artist: "花澤香菜", 
    src: "music/恋愛サーキュレーション - 花澤香菜.mp3", 
    cover: "music/恋愛サーキュレーション - 花澤香菜.jpg",
    lrcFile: "music/恋愛サーキュレーション - 花澤香菜.src"
  },
{ 
    title: "恋爱大过天", 
    artist: "Twins", 
    src: "music/恋爱大过天 - Twins.mp3", 
    cover: "music/恋爱大过天 - Twins.jpg",
    lrcFile: "music/恋爱大过天 - Twins.src"
  },
{ 
    title: "恶作剧", 
    artist: "林依晨", 
    src: "music/恶作剧 - 林依晨.mp3", 
    cover: "music/恶作剧 - 林依晨.jpg",
    lrcFile: "music/恶作剧 - 林依晨.src"
  },
{ 
    title: "情歌", 
    artist: "关心妍", 
    src: "music/情歌 - 关心妍.mp3", 
    cover: "music/情歌 - 关心妍.jpg",
    lrcFile: "music/情歌 - 关心妍.src"
  },
{ 
    title: "我们的歌", 
    artist: "王力宏", 
    src: "music/我们的歌 - 王力宏.mp3", 
    cover: "music/我们的歌 - 王力宏.jpg",
    lrcFile: "music/我们的歌 - 王力宏.src"
  },
{ 
    title: "我们的爱", 
    artist: "飞儿乐团", 
    src: "music/我们的爱 - 飞儿乐团.mp3", 
    cover: "music/我们的爱 - 飞儿乐团.jpg",
    lrcFile: "music/我们的爱 - 飞儿乐团.src"
  },
{ 
    title: "我怀念的", 
    artist: "孙燕姿", 
    src: "music/我怀念的 - 孙燕姿.mp3", 
    cover: "music/我怀念的 - 孙燕姿.jpg",
    lrcFile: "music/我怀念的 - 孙燕姿.src"
  },
{ 
    title: "我的回忆不是我的", 
    artist: "海鸣威", 
    src: "music/我的回忆不是我的 - 海鸣威.mp3", 
    cover: "music/我的回忆不是我的 - 海鸣威.jpg",
    lrcFile: "music/我的回忆不是我的 - 海鸣威.src"
  },
{ 
    title: "我知道 (电视剧《比赛开始》片尾曲)", 
    artist: "BY2", 
    src: "music/我知道 (电视剧《比赛开始》片尾曲) - BY2.mp3", 
    cover: "music/我知道 (电视剧《比赛开始》片尾曲) - BY2.jpg",
    lrcFile: "music/我知道 (电视剧《比赛开始》片尾曲) - BY2.src"
  },
{ 
    title: "戒不掉", 
    artist: "欧阳耀莹", 
    src: "music/戒不掉 - 欧阳耀莹.mp3", 
    cover: "music/戒不掉 - 欧阳耀莹.jpg",
    lrcFile: "music/戒不掉 - 欧阳耀莹.src"
  },
{ 
    title: "房间", 
    artist: "刘瑞琦", 
    src: "music/房间 - 刘瑞琦.mp3", 
    cover: "music/房间 - 刘瑞琦.jpg",
    lrcFile: "music/房间 - 刘瑞琦.src"
  },
{ 
    title: "扉をあけて", 
    artist: "ANZA", 
    src: "music/扉をあけて - ANZA.mp3", 
    cover: "music/扉をあけて - ANZA.jpg",
    lrcFile: "music/扉をあけて - ANZA.src"
  },
{ 
    title: "无人之境", 
    artist: "陈奕迅", 
    src: "music/无人之境 - 陈奕迅.mp3", 
    cover: "music/无人之境 - 陈奕迅.jpg",
    lrcFile: "music/无人之境 - 陈奕迅.src"
  },
{ 
    title: "无人之岛", 
    artist: "任然", 
    src: "music/无人之岛 - 任然.mp3", 
    cover: "music/无人之岛 - 任然.jpg",
    lrcFile: "music/无人之岛 - 任然.src"
  },
{ 
    title: "无条件", 
    artist: "陈奕迅", 
    src: "music/无条件 - 陈奕迅.mp3", 
    cover: "music/无条件 - 陈奕迅.jpg",
    lrcFile: "music/无条件 - 陈奕迅.src"
  },
{ 
    title: "明年今日", 
    artist: "陈奕迅", 
    src: "music/明年今日 - 陈奕迅.mp3", 
    cover: "music/明年今日 - 陈奕迅.jpg",
    lrcFile: "music/明年今日 - 陈奕迅.src"
  },
{ 
    title: "春娇与志明", 
    artist: "街道办GDC,欧阳耀莹", 
    src: "music/春娇与志明 - 街道办GDC,欧阳耀莹.mp3", 
    cover: "music/春娇与志明 - 街道办GDC,欧阳耀莹.jpg",
    lrcFile: "music/春娇与志明 - 街道办GDC,欧阳耀莹.src"
  },
{ 
    title: "是非题", 
    artist: "范玮琪", 
    src: "music/是非题 - 范玮琪.mp3", 
    cover: "music/是非题 - 范玮琪.jpg",
    lrcFile: "music/是非题 - 范玮琪.src"
  },
{ 
    title: "暖暖", 
    artist: "梁静茹", 
    src: "music/暖暖 - 梁静茹.mp3", 
    cover: "music/暖暖 - 梁静茹.jpg",
    lrcFile: "music/暖暖 - 梁静茹.src"
  },
{ 
    title: "暗恋航空", 
    artist: "官恩娜", 
    src: "music/暗恋航空 - 官恩娜.mp3", 
    cover: "music/暗恋航空 - 官恩娜.jpg",
    lrcFile: "music/暗恋航空 - 官恩娜.src"
  },
{ 
    title: "有点甜", 
    artist: "汪苏泷+BY2", 
    src: "music/有点甜 - 汪苏泷+BY2.mp3", 
    cover: "music/有点甜 - 汪苏泷+BY2.jpg",
    lrcFile: "music/有点甜 - 汪苏泷+BY2.src"
  },
{ 
    title: "樱花树下", 
    artist: "张敬轩", 
    src: "music/樱花树下 - 张敬轩.mp3", 
    cover: "music/樱花树下 - 张敬轩.jpg",
    lrcFile: "music/樱花树下 - 张敬轩.src"
  },
{ 
    title: "樱花草", 
    artist: "Sweety", 
    src: "music/樱花草 - Sweety.mp3", 
    cover: "music/樱花草 - Sweety.jpg",
    lrcFile: "music/樱花草 - Sweety.src"
  },
{ 
    title: "沙龙", 
    artist: "陈奕迅", 
    src: "music/沙龙 - 陈奕迅.mp3", 
    cover: "music/沙龙 - 陈奕迅.jpg",
    lrcFile: "music/沙龙 - 陈奕迅.src"
  },
{ 
    title: "爱与诚", 
    artist: "古巨基", 
    src: "music/爱与诚 - 古巨基.mp3", 
    cover: "music/爱与诚 - 古巨基.jpg",
    lrcFile: "music/爱与诚 - 古巨基.src"
  },
{ 
    title: "爱的魔法", 
    artist: "金莎", 
    src: "music/爱的魔法 - 金莎.mp3", 
    cover: "music/爱的魔法 - 金莎.jpg",
    lrcFile: "music/爱的魔法 - 金莎.src"
  },
{ 
    title: "猜不透", 
    artist: "丁当", 
    src: "music/猜不透 - 丁当.mp3", 
    cover: "music/猜不透 - 丁当.jpg",
    lrcFile: "music/猜不透 - 丁当.src"
  },
{ 
    title: "相逢何必曾相识", 
    artist: "蒋志光&韦绮姗", 
    src: "music/相逢何必曾相识 - 蒋志光&韦绮姗.mp3", 
    cover: "music/相逢何必曾相识 - 蒋志光&韦绮姗.jpg",
    lrcFile: "music/相逢何必曾相识 - 蒋志光&韦绮姗.src"
  },
{ 
    title: "睡公主", 
    artist: "G.E.M.邓紫棋", 
    src: "music/睡公主 - G.E.M.邓紫棋.mp3", 
    cover: "music/睡公主 - G.E.M.邓紫棋.jpg",
    lrcFile: "music/睡公主 - G.E.M.邓紫棋.src"
  },
{ 
    title: "红绿灯", 
    artist: "郑融", 
    src: "music/红绿灯 - 郑融.mp3", 
    cover: "music/红绿灯 - 郑融.jpg",
    lrcFile: "music/红绿灯 - 郑融.src"
  },
{ 
    title: "落花流水", 
    artist: "陈奕迅", 
    src: "music/落花流水 - 陈奕迅.mp3", 
    cover: "music/落花流水 - 陈奕迅.jpg",
    lrcFile: "music/落花流水 - 陈奕迅.src"
  },
{ 
    title: "街灯晚餐", 
    artist: "卫兰", 
    src: "music/街灯晚餐 - 卫兰.mp3", 
    cover: "music/街灯晚餐 - 卫兰.jpg",
    lrcFile: "music/街灯晚餐 - 卫兰.src"
  },
{ 
    title: "起风了", 
    artist: "周深", 
    src: "music/起风了 - 周深.mp3", 
    cover: "music/起风了 - 周深.jpg",
    lrcFile: "music/起风了 - 周深.src"
  },
{ 
    title: "越难越爱", 
    artist: "吴若希", 
    src: "music/越难越爱 - 吴若希.mp3", 
    cover: "music/越难越爱 - 吴若希.jpg",
    lrcFile: "music/越难越爱 - 吴若希.src"
  },
{ 
    title: "路过人间", 
    artist: "郁可唯", 
    src: "music/路过人间 - 郁可唯.mp3", 
    cover: "music/路过人间 - 郁可唯.jpg",
    lrcFile: "music/路过人间 - 郁可唯.src"
  },
{ 
    title: "身骑白马", 
    artist: "徐佳莹", 
    src: "music/身骑白马 - 徐佳莹.mp3", 
    cover: "music/身骑白马 - 徐佳莹.jpg",
    lrcFile: "music/身骑白马 - 徐佳莹.src"
  },
{ 
    title: "远在咫尺", 
    artist: "陈奕迅", 
    src: "music/远在咫尺 - 陈奕迅.mp3", 
    cover: "music/远在咫尺 - 陈奕迅.jpg",
    lrcFile: "music/远在咫尺 - 陈奕迅.src"
  },
{ 
    title: "野孩子", 
    artist: "杨千嬅", 
    src: "music/野孩子 - 杨千嬅.mp3", 
    cover: "music/野孩子 - 杨千嬅.jpg",
    lrcFile: "music/野孩子 - 杨千嬅.src"
  },
{ 
    title: "钟无艳", 
    artist: "谢安琪", 
    src: "music/钟无艳 - 谢安琪.mp3", 
    cover: "music/钟无艳 - 谢安琪.jpg",
    lrcFile: "music/钟无艳 - 谢安琪.src"
  },
{ 
    title: "雨爱", 
    artist: "杨丞琳", 
    src: "music/雨爱 - 杨丞琳.mp3", 
    cover: "music/雨爱 - 杨丞琳.jpg",
    lrcFile: "music/雨爱 - 杨丞琳.src"
  },
{ 
    title: "青花瓷", 
    artist: "周杰伦", 
    src: "music/青花瓷 - 周杰伦.mp3", 
    cover: "music/青花瓷 - 周杰伦.jpg",
    lrcFile: "music/青花瓷 - 周杰伦.src"
  },
{ 
    title: "风吹一夏", 
    artist: "DP龙猪,Swei水,Rays陈袁", 
    src: "music/风吹一夏 - DP龙猪,Swei水,Rays陈袁.mp3", 
    cover: "music/风吹一夏 - DP龙猪,Swei水,Rays陈袁.jpg",
    lrcFile: "music/风吹一夏 - DP龙猪,Swei水,Rays陈袁.src"
  },
{ 
    title: "高山低谷", 
    artist: "林匡奕", 
    src: "music/高山低谷 - 林匡奕.mp3", 
    cover: "music/高山低谷 - 林匡奕.jpg",
    lrcFile: "music/高山低谷 - 林匡奕.src"
  }
];

const audio = document.getElementById('audio');
const playlistEl = document.getElementById('playlist');
const lyricsEl = document.getElementById('lyrics');
const titleEl = document.getElementById('songTitle');
const coverEl = document.getElementById('cover');
const modeBtn = document.getElementById('modeBtn');

let currentIndex = 0;
let currentLyrics = [];
// 播放模式: 0-列表循环, 1-单曲循环, 2-随机播放
let playMode = 0; 
const modeTexts = ["列表循环", "单曲循环", "随机播放"];

// 初始化播放列表
songs.forEach((song, index) => {
  const div = document.createElement('div');
  div.className = 'song';
  div.textContent = song.title;
  div.onclick = () => loadSong(index);
  playlistEl.appendChild(div);
});

// 切换播放模式
function toggleMode() {
  playMode = (playMode + 1) % 3;
  modeBtn.textContent = modeTexts[playMode];
}

function loadSong(index) {
  currentIndex = index;
  document.querySelectorAll('.song').forEach(el => el.classList.remove('active'));
  if(playlistEl.children[index]) {
      playlistEl.children[index].classList.add('active');
  }

  const song = songs[index];
  titleEl.textContent = song.title;
  audio.src = song.src;
  coverEl.style.backgroundImage = `url('${song.cover}')`;
  audio.play().catch(e => console.log("等待用户交互后播放"));

  fetch(song.lrcFile)
    .then(res => res.text())
    .then(text => {
      currentLyrics = parseLRC(text);
      renderLyrics();
    }).catch(() => {
      lyricsEl.innerHTML = '暂无歌词';
    });
}

function parseLRC(lrc) {
  return lrc.trim().split('\n').map(line => {
    const match = line.match(/\[(\d+):(\d+\.\d+)\](.*)/);
    if (!match) return null;
    return { time: parseInt(match[1]) * 60 + parseFloat(match[2]), text: match[3] };
  }).filter(Boolean);
}

function renderLyrics() {
  lyricsEl.innerHTML = '';
  currentLyrics.forEach(l => {
    const div = document.createElement('div');
    div.className = 'line';
    div.dataset.time = l.time;
    div.textContent = l.text;
    lyricsEl.appendChild(div);
  });
}

audio.addEventListener('timeupdate', () => {
  const currentTime = audio.currentTime;
  const lines = document.querySelectorAll('.line');
  lines.forEach((line, index) => {
    const next = lines[index + 1];
    if (currentTime >= line.dataset.time && (!next || currentTime < next.dataset.time)) {
      line.classList.add('active');
      line.scrollIntoView({ block: 'center', behavior: 'smooth' });
    } else {
      line.classList.remove('active');
    }
  });
  localStorage.setItem('lastSongIndex', currentIndex);
  localStorage.setItem('lastTime', audio.currentTime);
});

// 核心逻辑：播放结束后的处理
audio.addEventListener('ended', () => {
  if (playMode === 1) { 
    // 单曲循环
    audio.currentTime = 0;
    audio.play();
  } else if (playMode === 2) { 
    // 随机播放
    let randomIndex;
    do {
      randomIndex = Math.floor(Math.random() * songs.length);
    } while (songs.length > 1 && randomIndex === currentIndex);
    loadSong(randomIndex);
  } else {
    // 列表循环
    nextSong();
  }
});

function nextSong() {
  let nextIndex = (currentIndex + 1) % songs.length;
  loadSong(nextIndex);
}

function prevSong() {
  let prevIndex = (currentIndex - 1 + songs.length) % songs.length;
  loadSong(prevIndex);
}

window.addEventListener('load', () => {
  const lastIndex = localStorage.getItem('lastSongIndex');
  const lastTime = localStorage.getItem('lastTime');
  if (lastIndex !== null && songs[lastIndex]) {
    loadSong(Number(lastIndex));
    audio.currentTime = lastTime ? Number(lastTime) : 0;
  } else {
    loadSong(0);
  }
});
</script>
</body>
</html>